<!DOCTYPE html>
<html lang="">
<head>
  <meta charset="UTF-8">
  <title>Atlas</title>
  <link rel="stylesheet" href="/home-style.css">
</head>
<body>
<div class="topnavbar">
  <ul class="snip1143">
    <li class="current"><a href="home" data-hover="Home">Home</a></li>
    <li><a href="tutorial" data-hover="Tutorial">Como usar</a></li>
    <li><a href="post" data-hover="Posts">Posts</a></li>
    <li><a href="login" data-hover="Login">entrar</a></li>
    <li><a href="filter" data-hover="Filtros">Buscar</a></li>
  </ul>
</div>
<div class="ATLAS">
  <div class="content">
    <div id="regions_div"></div>
  </div>
</div>
<footer id="footer">
  <small>
    Copyright Â© 2023 Atlas. All Rights Reserved.
  </small>
</footer>
<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
  google.charts.load('current', {
    callback: function () {
      fetch('https://restcountries.com/v3.1/all?fields=name,flags,capital,population,currencies,languages,continents')
              .then(response => response.json())
              .then(data => {
                var dataArray = [];
                dataArray.push(['Country', 'Value', {role: 'tooltip', p:{html:true}}])

                data.forEach(country => {
                  var flagUrl = country.flags.png;
                  var officialName = country.name.official;
                  var commonName = country.name.common;

                  var population = country.population;
                  var capital = country.capital[0];
                  var languages = Object.values(country.languages).join(', ');
                  var currencies = Object.keys(country.currencies).join(', ');

                  dataArray.push(["Czech Republic", 200, '<img width="75%" height="75%" src="' + "https://flagcdn.com/w320/cz.png" + '" alt="Flag of ' + "Czech Republic" + '">' +
                  '<p>Official Name: ' + "Czech Republic" + '</p>' +
                  '<p>Population: ' + 10698896 + '</p>' +
                  '<p>Capital: ' + "Prague" + '</p>' +
                  '<p>Languages: ' + "Czech, Slovak" + '</p>' +
                  '<p>Currencies: ' + "CZK" + '</p>']);

                  dataArray.push(["MK", 200, '<img width="75%" height="75%" src="' + "https://flagcdn.com/w320/cz.png" + '" alt="Flag of ' + "Republic of North Macedonia" + '">' +
                  '<p>Official Name: ' + "Republic of North Macedonia" + '</p>' +
                  '<p>Population: ' + 2077132 + '</p>' +
                  '<p>Capital: ' + "Skopje" + '</p>' +
                  '<p>Languages: ' + "Macedonian" + '</p>' +
                  '<p>Currencies: ' + "MKD" + '</p>']);




                  var tooltipContent = '<img width="75%" height="75%" src="' + flagUrl + '" alt="Flag of ' + officialName + '">' +
                          '<p>Official Name: ' + officialName + '</p>' +
                          '<p>Population: ' + population + '</p>' +
                          '<p>Capital: ' + capital + '</p>' +
                          '<p>Languages: ' + languages + '</p>' +
                          '<p>Currencies: ' + currencies + '</p>';

                  dataArray.push([commonName, 200, tooltipContent]);
                });

                var data = google.visualization.arrayToDataTable(dataArray);
                var view = new google.visualization.DataView(data);

                var selectedCountry = null;
                var options = {
                  region: 'world',
                  colorAxis: { colors: ['blue', '#318f34'] },
                  backgroundColor: '#81d4fa',
                  datalessRegionColor: 'white',
                  defaultColor: '#f5f5f5',
                  enableRegionInteractivity: true,
                  tooltip: {
                    isHtml: true,
                    textStyle: { fontSize: 15, color: 'black', fontName: 'Arial' },
                    trigger: 'focus',
                    opacity: 0.9,
                    borderColor: 'crimson',
                    borderRadius: 5,
                    showColorCode: false,
                    showTitle: true,
                    titleTextStyle: { fontSize: 16, color: 'blue', fontName: 'Arial' },
                  },
                };

                var chart = new google.visualization.GeoChart(document.getElementById('regions_div'));

                function resizeChart() {
                  chart.draw(view, options);
                }

                google.visualization.events.addListener(chart, 'regionClick', function (eventData) {
                  var clickedRegion = eventData.region;

                  if (selectedCountry === clickedRegion) {
                    selectedCountry = null;
                    options.region = 'world';
                  } else {
                    selectedCountry = clickedRegion;
                    options.region = clickedRegion;
                  }
                  resizeChart();
                });

                if (window.addEventListener) {
                  window.addEventListener('resize', resizeChart);
                } else if (window.attachEvent) {
                  window.attachEvent('onresize', resizeChart);
                }

                resizeChart();
              });
    },
    packages: ['geochart']
  });

</script>
</body>
</html>